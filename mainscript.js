const firebaseApp=firebase.initializeApp({apiKey:"AIzaSyAqLhZwCi01etkdPm014QzSNeUlKrOfKjo",authDomain:"tudum-7f057.firebaseapp.com",databaseURL:"https://tudum-7f057-default-rtdb.firebaseio.com",projectId:"tudum-7f057",storageBucket:"tudum-7f057.firebasestorage.app",messagingSenderId:"384146644184",appId:"1:384146644184:web:5dbe0c8f242498df08cbad"}),db=firebaseApp.firestore(),auth=firebaseApp.auth(),database=firebaseApp.database(),proElement=document.getElementById("pro"),toast=document.getElementById("toast"),renet=()=>{let e=document.querySelectorAll("img");e.forEach(e=>{let t=e.getAttribute("src");[...e.attributes].forEach(t=>{"src"!==t.name&&e.removeAttribute(t.name)}),e.setAttribute("src",t),e.setAttribute("onclick",'location.href="signin.html"')})},resub=()=>{let e=document.querySelectorAll("#premium");e.forEach(e=>{let t=e.getAttribute("src");[...e.attributes].forEach(t=>{"src"!==t.name&&e.removeAttribute(t.name)}),e.setAttribute("src",t),e.setAttribute("onclick","showpay()")})},showpay=()=>{document.querySelector(".recharge").style.display="block",setTimeout(()=>{document.querySelector(".recharge").style.display="none"},3e3)},rmvLock=()=>{document.querySelectorAll(".fi.fi-sr-lock").forEach(e=>{e&&e.remove()})},blurImg=()=>{document.querySelectorAll("img").forEach(e=>{e.classList.add("display-block")})},checkUserSignIn=()=>{firebase.auth().onAuthStateChanged(e=>{if(e)checkUserSubscription(),document.getElementById("email").innerText=e.email;else{renet(),blurImg();let t=document.getElementById("Logout");t&&(t.setAttribute("onclick",'location.href="signin.html"'),t.innerText="SignIn",t.style.backgroundColor="green")}})};firebase.auth().onAuthStateChanged(e=>{if(e)localStorage.setItem("persistedUser",JSON.stringify({email:e.email}));else{let t=localStorage.getItem("persistedUser");t&&(localStorage.removeItem("persistedUser"),toast.innerText="You have been banned from this site. Please contact support.",toast.style.display="block")}});const checkUserSubscription=async()=>{let e=firebase.auth().currentUser;if(e){let t=localStorage.getItem("subscription");t&&updateSubscriptionUI(t);try{let r=await db.collection("users").doc(e.uid).get();if(r.exists){let n=r.data().subscription;n!==t&&(localStorage.setItem("subscription",n),updateSubscriptionUI(n))}}catch(i){console.error("Error checking subscription:",i)}}};function updateSubscriptionUI(e){"premium"===e?(rmvLock(),blurImg(),proElement.innerText=" You Have Premium Account",document.getElementById("subscribe").innerText="Renew Subscription",document.querySelector(".recharge").style.display="none"):"free"===e&&(resub(),blurImg(),proElement.innerText="You Have Free Account")}const signOut=()=>{let e=auth.currentUser;e?db.collection("users").doc(e.uid).update({ip:""}).then(()=>{console.log("IP field cleared in Firestore"),firebase.auth().signOut().then(()=>{localStorage.removeItem("firebase:authUser:"+firebaseApp.options.apiKey+":[DEFAULT]"),localStorage.removeItem("subscription"),window.location.replace("signin.html")}).catch(e=>{console.error("Error signing out:",e)})}).catch(e=>{console.error("Error clearing IP field:",e)}):console.error("No user is currently signed in.")};function toggleGridDisplay(e,t){document.querySelectorAll("#a1, #a2, #a3").forEach(e=>{e.style.display=t===e.id?"grid":"none"})}function setActiveButton(e){["movie","sign-in","likely"].forEach(t=>{let r=document.getElementById(t);r&&(r.style.color=t===e?"white":"")})}document.querySelectorAll(".box,.upcoming").forEach(e=>{e.addEventListener("wheel",t=>{t.preventDefault(),e.scrollLeft+=t.deltaY})}),document.querySelectorAll("#movie-request").forEach(e=>{e.addEventListener("click",function(){let e=document.createElement("div");e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.width="22em",e.style.height="70%",e.style.backgroundColor="white",e.style.boxShadow="0 4px 8px rgba(0, 0, 0, 0.2)",e.style.zIndex="1000",e.style.borderRadius="8px",e.style.overflow="hidden";let t=document.createElement("iframe");t.src="https://tally.so/r/w7PLvP",t.style.width="100%",t.style.height="100%",t.style.border="none",e.appendChild(t);let r=document.createElement("button");r.textContent="\xd7",r.style.position="absolute",r.style.top="0.5em",r.style.right="0.5em",r.style.backgroundColor="#f44336",r.style.color="white",r.style.border="none",r.style.borderRadius="4px",r.style.padding="0.3em 0.6em",r.style.cursor="pointer",r.style.fontSize="0.9em",r.addEventListener("click",function(){document.body.removeChild(e)}),e.appendChild(r),document.body.appendChild(e)})}),document.getElementById("movie").addEventListener("click",()=>{toggleGridDisplay("movie","a1"),setActiveButton("movie")}),document.getElementById("sign-in").addEventListener("click",()=>{toggleGridDisplay("sign-in","a2"),setActiveButton("sign-in")}),document.getElementById("likely").addEventListener("click",()=>{toggleGridDisplay("likely","a3"),setActiveButton("likely")}),document.addEventListener("DOMContentLoaded",()=>{toggleGridDisplay("movie","a1"),setActiveButton("movie"),checkUserSignIn()}),document.addEventListener("copy",e=>{e.preventDefault()}),document.addEventListener("contextmenu",e=>{e.preventDefault()}),document.addEventListener("selectstart",e=>{e.preventDefault()}),document.addEventListener("touchstart",e=>{if("IMG"===e.target.tagName||"DIV"===e.target.tagName||"P"===e.target.tagName){let t=setTimeout(()=>{e.preventDefault()},500);e.target.addEventListener("touchend",()=>clearTimeout(t),{once:!0})}}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("username"),t=localStorage.getItem("username");t&&e?e.innerText=t:firebase.auth().onAuthStateChanged(async t=>{if(t)try{let r=await db.collection("users").doc(t.uid).get();if(r.exists){let n=r.data().name;n&&(localStorage.setItem("username",n),e&&(e.innerText=n))}}catch(i){console.error("Error fetching user name:",i)}})}),document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".modal"),t=()=>{e&&(e.style.display="none")};document.getElementById("searchButton").addEventListener("click",()=>{e&&(e.style.display="block",history.pushState(null,null,location.href))}),document.getElementById("closeModal").addEventListener("click",t),window.addEventListener("popstate",()=>{e&&"block"===e.style.display&&(t(),history.pushState(null,null,location.href))})}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("searchInput"),t=document.querySelector(".box2");if(!e||!t)return;let r=()=>{let r=e.value.toLowerCase().trim();t.innerHTML="",document.querySelectorAll(".box p").forEach(e=>{if(e.textContent.toLowerCase().includes(r)){let n=e.closest("div");n&&t.appendChild(n.cloneNode(!0))}})};e.addEventListener("input",r),e.addEventListener("keydown",e=>{"Enter"===e.key&&e.preventDefault()});let n=document.querySelector(".box"),i=new MutationObserver(()=>r());n&&i.observe(n,{childList:!0,subtree:!0})}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("clearWatchlist");e&&e.addEventListener("click",()=>{let e=document.querySelector(".watchlist");e&&(e.innerHTML="",localStorage.removeItem("watchlist"))})}),firebase.auth().onAuthStateChanged(e=>{let t=database.ref("activeUsers").push();e&&e.email?t.set({email:e.email,active:!0}):t.set({email:null,active:!0}),t.onDisconnect().remove(),database.ref("activeUsers").on("value",e=>{let t=e.val()||{},r=Object.keys(t).length,n=Object.values(t).map(e=>e.email).filter(e=>!!e);console.log("Active users:",r,"Emails:",n)})}),function e(){let t=0,r=0,n=!1,i=null;window.addEventListener("touchstart",function(e){0===window.scrollY?(n=!0,t=e.touches[0].clientY):n=!1},{passive:!0}),window.addEventListener("touchmove",function(e){n&&(r=e.touches[0].clientY)-t>60&&(function e(){let t=document.getElementById("refreshPage");t&&(t.style.display="block",clearTimeout(i),i=setTimeout(()=>{t.style.display="none"},5e3))}(),n=!1)},{passive:!0}),window.addEventListener("scroll",function e(){let t=document.getElementById("refreshPage");t&&(t.style.display="none")})}();